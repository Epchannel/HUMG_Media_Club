/*
colpick Color Picker
Copyright 2013 Jose Vargas. Licensed under GPL license. Based on Stefan Petre's Color Picker www.eyecon.ro, dual licensed under the MIT and GPL licenses

For usage and examples: colpick.com/plugin
 */

!function(t){var a,e,i,c,o,l,r,d,n,s,p,u,h,f,v,g,k,_,m,b,x,y,w,M,I,C,T,q,S=(a={showEvent:"click",onShow:function(){},onBeforeShow:function(){},onHide:function(){},onChange:function(){},onSubmit:function(){},colorScheme:"light",color:"3289c7",livePreview:!0,flat:!1,layout:"full",submit:1,submitText:"OK",height:156},e=function(a,e){var i=P(a);t(e).data("colpick").fields.eq(1).val(i.r).end().eq(2).val(i.g).end().eq(3).val(i.b).end()},i=function(a,e){t(e).data("colpick").fields.eq(4).val(Math.round(a.h)).end().eq(5).val(Math.round(a.s)).end().eq(6).val(Math.round(a.b)).end()},c=function(a,e){t(e).data("colpick").fields.eq(0).val(H(a))},o=function(a,e){t(e).data("colpick").selector.css("backgroundColor","#"+H({h:a.h,s:100,b:100})),t(e).data("colpick").selectorIndic.css({left:parseInt(t(e).data("colpick").height*a.s/100,10),top:parseInt(t(e).data("colpick").height*(100-a.b)/100,10)})},l=function(a,e){t(e).data("colpick").hue.css("top",parseInt(t(e).data("colpick").height-t(e).data("colpick").height*a.h/360,10))},r=function(a,e){t(e).data("colpick").currentColor.css("backgroundColor","#"+H(a))},d=function(a,e){t(e).data("colpick").newColor.css("backgroundColor","#"+H(a))},n=function(a){var r,n=t(this).parent().parent();this.parentNode.className.indexOf("_hex")>0?(n.data("colpick").color=r=E(T(this.value)),e(r,n.get(0)),i(r,n.get(0))):this.parentNode.className.indexOf("_hsb")>0?(n.data("colpick").color=r=I({h:parseInt(n.data("colpick").fields.eq(4).val(),10),s:parseInt(n.data("colpick").fields.eq(5).val(),10),b:parseInt(n.data("colpick").fields.eq(6).val(),10)}),e(r,n.get(0)),c(r,n.get(0))):(n.data("colpick").color=r=L(C({r:parseInt(n.data("colpick").fields.eq(1).val(),10),g:parseInt(n.data("colpick").fields.eq(2).val(),10),b:parseInt(n.data("colpick").fields.eq(3).val(),10)})),c(r,n.get(0)),i(r,n.get(0))),o(r,n.get(0)),l(r,n.get(0)),d(r,n.get(0)),n.data("colpick").onChange.apply(n.parent(),[r,H(r),P(r),n.data("colpick").el,0])},s=function(a){t(this).parent().removeClass("colpick_focus")},p=function(){t(this).parent().parent().data("colpick").fields.parent().removeClass("colpick_focus"),t(this).parent().addClass("colpick_focus")},u=function(a){a.preventDefault?a.preventDefault():a.returnValue=!1;var e=t(this).parent().find("input").focus(),i={el:t(this).parent().addClass("colpick_slider"),max:this.parentNode.className.indexOf("_hsb_h")>0?360:this.parentNode.className.indexOf("_hsb")>0?100:255,y:a.pageY,field:e,val:parseInt(e.val(),10),preview:t(this).parent().parent().data("colpick").livePreview};t(document).mouseup(i,f),t(document).mousemove(i,h)},h=function(t){return t.data.field.val(Math.max(0,Math.min(t.data.max,parseInt(t.data.val-t.pageY+t.data.y,10)))),t.data.preview&&n.apply(t.data.field.get(0),[!0]),!1},f=function(a){return n.apply(a.data.field.get(0),[!0]),a.data.el.removeClass("colpick_slider").find("input").focus(),t(document).off("mouseup",f),t(document).off("mousemove",h),!1},v=function(a){a.preventDefault?a.preventDefault():a.returnValue=!1;var e={cal:t(this).parent(),y:t(this).offset().top};t(document).on("mouseup touchend",e,k),t(document).on("mousemove touchmove",e,g);var i="touchstart"==a.type?a.originalEvent.changedTouches[0].pageY:a.pageY;return n.apply(e.cal.data("colpick").fields.eq(4).val(parseInt(360*(e.cal.data("colpick").height-(i-e.y))/e.cal.data("colpick").height,10)).get(0),[e.cal.data("colpick").livePreview]),!1},g=function(t){var a="touchmove"==t.type?t.originalEvent.changedTouches[0].pageY:t.pageY;return n.apply(t.data.cal.data("colpick").fields.eq(4).val(parseInt(360*(t.data.cal.data("colpick").height-Math.max(0,Math.min(t.data.cal.data("colpick").height,a-t.data.y)))/t.data.cal.data("colpick").height,10)).get(0),[t.data.preview]),!1},k=function(a){return e(a.data.cal.data("colpick").color,a.data.cal.get(0)),c(a.data.cal.data("colpick").color,a.data.cal.get(0)),t(document).off("mouseup touchend",k),t(document).off("mousemove touchmove",g),!1},_=function(a){a.preventDefault?a.preventDefault():a.returnValue=!1;var e,i={cal:t(this).parent(),pos:t(this).offset()};return i.preview=i.cal.data("colpick").livePreview,t(document).on("mouseup touchend",i,b),t(document).on("mousemove touchmove",i,m),"touchstart"==a.type?(pageX=a.originalEvent.changedTouches[0].pageX,e=a.originalEvent.changedTouches[0].pageY):(pageX=a.pageX,e=a.pageY),n.apply(i.cal.data("colpick").fields.eq(6).val(parseInt(100*(i.cal.data("colpick").height-(e-i.pos.top))/i.cal.data("colpick").height,10)).end().eq(5).val(parseInt(100*(pageX-i.pos.left)/i.cal.data("colpick").height,10)).get(0),[i.preview]),!1},m=function(t){var a;return"touchmove"==t.type?(pageX=t.originalEvent.changedTouches[0].pageX,a=t.originalEvent.changedTouches[0].pageY):(pageX=t.pageX,a=t.pageY),n.apply(t.data.cal.data("colpick").fields.eq(6).val(parseInt(100*(t.data.cal.data("colpick").height-Math.max(0,Math.min(t.data.cal.data("colpick").height,a-t.data.pos.top)))/t.data.cal.data("colpick").height,10)).end().eq(5).val(parseInt(100*Math.max(0,Math.min(t.data.cal.data("colpick").height,pageX-t.data.pos.left))/t.data.cal.data("colpick").height,10)).get(0),[t.data.preview]),!1},b=function(a){return e(a.data.cal.data("colpick").color,a.data.cal.get(0)),c(a.data.cal.data("colpick").color,a.data.cal.get(0)),t(document).off("mouseup touchend",b),t(document).off("mousemove touchmove",m),!1},x=function(a){var e=t(this).parent(),i=e.data("colpick").color;e.data("colpick").origColor=i,r(i,e.get(0)),e.data("colpick").onSubmit(i,H(i),P(i),e.data("colpick").el)},y=function(a){a.stopPropagation();var e=t("#"+t(this).data("colpickId"));e.data("colpick").onBeforeShow.apply(this,[e.get(0)]);var i=t(this).offset(),c=i.top+this.offsetHeight,o=i.left,l=M(),r=e.width();o+r>l.l+l.w&&(o-=r),e.css({left:o+"px",top:c+"px"}),0!=e.data("colpick").onShow.apply(this,[e.get(0)])&&e.show(),t("html").mousedown({cal:e},w),e.mousedown((function(t){t.stopPropagation()}))},w=function(a){0!=a.data.cal.data("colpick").onHide.apply(this,[a.data.cal.get(0)])&&a.data.cal.hide(),t("html").off("mousedown",w)},M=function(){var t="CSS1Compat"==document.compatMode;return{l:window.pageXOffset||(t?document.documentElement.scrollLeft:document.body.scrollLeft),w:window.innerWidth||(t?document.documentElement.clientWidth:document.body.clientWidth)}},I=function(t){return{h:Math.min(360,Math.max(0,t.h)),s:Math.min(100,Math.max(0,t.s)),b:Math.min(100,Math.max(0,t.b))}},C=function(t){return{r:Math.min(255,Math.max(0,t.r)),g:Math.min(255,Math.max(0,t.g)),b:Math.min(255,Math.max(0,t.b))}},T=function(t){var a=6-t.length;if(a>0){for(var e=[],i=0;i<a;i++)e.push("0");e.push(t),t=e.join("")}return t},q=function(){var a=t(this).parent(),r=a.data("colpick").origColor;a.data("colpick").color=r,e(r,a.get(0)),c(r,a.get(0)),i(r,a.get(0)),o(r,a.get(0)),l(r,a.get(0)),d(r,a.get(0))},{init:function(h){if("string"==typeof(h=t.extend({},a,h||{})).color)h.color=E(h.color);else if(null!=h.color.r&&null!=h.color.g&&null!=h.color.b)h.color=L(h.color);else{if(null==h.color.h||null==h.color.s||null==h.color.b)return this;h.color=I(h.color)}return this.each((function(){if(!t(this).data("colpickId")){var a=t.extend({},h);a.origColor=h.color;var f="collorpicker_"+parseInt(1e3*Math.random());t(this).data("colpickId",f);var g=t('<div class="colpick"><div class="colpick_color"><div class="colpick_color_overlay1"><div class="colpick_color_overlay2"><div class="colpick_selector_outer"><div class="colpick_selector_inner"></div></div></div></div></div><div class="colpick_hue"><div class="colpick_hue_arrs"><div class="colpick_hue_larr"></div><div class="colpick_hue_rarr"></div></div></div><div class="colpick_new_color"></div><div class="colpick_current_color"></div><div class="colpick_hex_field"><div class="colpick_field_letter">#</div><input type="text" maxlength="6" size="6" /></div><div class="colpick_rgb_r colpick_field"><div class="colpick_field_letter">R</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_rgb_g colpick_field"><div class="colpick_field_letter">G</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_rgb_b colpick_field"><div class="colpick_field_letter">B</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_hsb_h colpick_field"><div class="colpick_field_letter">H</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_hsb_s colpick_field"><div class="colpick_field_letter">S</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_hsb_b colpick_field"><div class="colpick_field_letter">B</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_submit"></div></div>').attr("id",f);g.addClass("colpick_"+a.layout+(a.submit?"":" colpick_"+a.layout+"_ns")),"light"!=a.colorScheme&&g.addClass("colpick_"+a.colorScheme),g.find("div.colpick_submit").html(a.submitText).click(x),a.fields=g.find("input").change(n).blur(s).focus(p),g.find("div.colpick_field_arrs").mousedown(u).end().find("div.colpick_current_color").click(q),a.selector=g.find("div.colpick_color").on("mousedown touchstart",_),a.selectorIndic=a.selector.find("div.colpick_selector_outer"),a.el=this,a.hue=g.find("div.colpick_hue_arrs"),huebar=a.hue.parent();var k,m,b=navigator.userAgent.toLowerCase(),w="Microsoft Internet Explorer"===navigator.appName,M=w?parseFloat(b.match(/msie ([0-9]{1,}[\.0-9]{0,})/)[1]):0,I=["#ff0000","#ff0080","#ff00ff","#8000ff","#0000ff","#0080ff","#00ffff","#00ff80","#00ff00","#80ff00","#ffff00","#ff8000","#ff0000"];if(w&&M<10)for(k=0;k<=11;k++)m=t("<div></div>").attr("style","height:8.333333%; filter:progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr="+I[k]+", endColorstr="+I[k+1]+'); -ms-filter: "progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr='+I[k]+", endColorstr="+I[k+1]+')";'),huebar.append(m);else stopList=I.join(","),huebar.attr("style","background:-webkit-linear-gradient(top,"+stopList+"); background: -o-linear-gradient(top,"+stopList+"); background: -ms-linear-gradient(top,"+stopList+"); background:-moz-linear-gradient(top,"+stopList+"); -webkit-linear-gradient(top,"+stopList+"); background:linear-gradient(to bottom,"+stopList+"); ");g.find("div.colpick_hue").on("mousedown touchstart",v),a.newColor=g.find("div.colpick_new_color"),a.currentColor=g.find("div.colpick_current_color"),g.data("colpick",a),e(a.color,g.get(0)),i(a.color,g.get(0)),c(a.color,g.get(0)),l(a.color,g.get(0)),o(a.color,g.get(0)),r(a.color,g.get(0)),d(a.color,g.get(0)),a.flat?(g.appendTo(this).show(),g.css({position:"relative",display:"block"})):(g.appendTo(document.body),t(this).on(a.showEvent,y),g.css({position:"absolute"}))}}))},showPicker:function(){return this.each((function(){t(this).data("colpickId")&&y.apply(this)}))},hidePicker:function(){return this.each((function(){t(this).data("colpickId")&&t("#"+t(this).data("colpickId")).hide()}))},setColor:function(a,n){if(n=void 0===n?1:n,"string"==typeof a)a=E(a);else if(null!=a.r&&null!=a.g&&null!=a.b)a=L(a);else{if(null==a.h||null==a.s||null==a.b)return this;a=I(a)}return this.each((function(){if(t(this).data("colpickId")){var s=t("#"+t(this).data("colpickId"));s.data("colpick").color=a,s.data("colpick").origColor=a,e(a,s.get(0)),i(a,s.get(0)),c(a,s.get(0)),l(a,s.get(0)),o(a,s.get(0)),d(a,s.get(0)),s.data("colpick").onChange.apply(s.parent(),[a,H(a),P(a),s.data("colpick").el,1]),n&&r(a,s.get(0))}}))}}),X=function(t){return{r:(t=parseInt(t.indexOf("#")>-1?t.substring(1):t,16))>>16,g:(65280&t)>>8,b:255&t}},E=function(t){return L(X(t))},L=function(t){var a={h:0,s:0,b:0},e=Math.min(t.r,t.g,t.b),i=Math.max(t.r,t.g,t.b),c=i-e;return a.b=i,a.s=0!=i?255*c/i:0,0!=a.s?t.r==i?a.h=(t.g-t.b)/c:t.g==i?a.h=2+(t.b-t.r)/c:a.h=4+(t.r-t.g)/c:a.h=-1,a.h*=60,a.h<0&&(a.h+=360),a.s*=100/255,a.b*=100/255,a},P=function(t){var a={},e=t.h,i=255*t.s/100,c=255*t.b/100;if(0==i)a.r=a.g=a.b=c;else{var o=c,l=(255-i)*c/255,r=e%60*(o-l)/60;360==e&&(e=0),e<60?(a.r=o,a.b=l,a.g=l+r):e<120?(a.g=o,a.b=l,a.r=o-r):e<180?(a.g=o,a.r=l,a.b=l+r):e<240?(a.b=o,a.r=l,a.g=o-r):e<300?(a.b=o,a.g=l,a.r=l+r):e<360?(a.r=o,a.g=l,a.b=o-r):(a.r=0,a.g=0,a.b=0)}return{r:Math.round(a.r),g:Math.round(a.g),b:Math.round(a.b)}},Y=function(a){var e=[a.r.toString(16),a.g.toString(16),a.b.toString(16)];return t.each(e,(function(t,a){1==a.length&&(e[t]="0"+a)})),e.join("")},H=function(t){return Y(P(t))};t.fn.extend({colpick:S.init,colpickHide:S.hidePicker,colpickShow:S.showPicker,colpickSetColor:S.setColor}),t.extend({colpick:{rgbToHex:Y,rgbToHsb:L,hsbToHex:H,hsbToRgb:P,hexToHsb:E,hexToRgb:X}})}(jQuery);
